<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>SC</title>
<link rel="icon" href="icon/favicon3.ico" type="image/x-icon">
<style>
body {
  margin: 0;
  padding: 0;
  font-family: sans-serif;
  background: linear-gradient(to bottom right, #1e1e2f, #3a3a5c);
  color: white;
}
#login {
  display: flex;
  height: 100vh;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}
#app {
  display: none;
  height: 100vh;
}
#main {
  display: flex;
  height: 100%;
}
#channels {
  width: 220px;
  background: #2f3136;
  padding: 10px;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  gap: 5px;
}
.channel {
  padding: 5px;
  cursor: pointer;
}
.channel:hover {
  background: #40444b;
}
.active {
  background: #5865f2;
}
#chat {
  flex: 1;
  display: flex;
  flex-direction: column;
  background: #36393f;
}
#chat-header {
  padding: 10px;
  background: #202225;
  border-bottom: 1px solid #444;
}
#messages {
  flex: 1;
  overflow-y: auto;
  padding: 10px;
}
#input-box {
  display: flex;
  border-top: 1px solid #444;
}
#input-box input {
  flex: 1;
  padding: 10px;
  border: none;
}
#input-box button {
  padding: 10px;
  background: #7289da;
  border: none;
  color: white;
}
.msg {
  margin-bottom: 5px;
}
.msg:hover .delete {
  display: inline;
}
.delete {
  display: none;
  color: red;
  cursor: pointer;
  margin-left: 10px;
}
#user-settings {
  margin-bottom: 10px;
  display: flex;
  flex-direction: column;
  gap: 5px;
}
#avatar-preview {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
}
#settings-panel {
  display: none;
  flex-direction: column;
  gap: 5px;
}
.vc-channel {
  background: #2f3136;
  padding: 5px;
  border-radius: 5px;
  margin-top: 5px;
}
.vc-users {
  display: flex;
  gap: 5px;
  margin-top: 5px;
  flex-wrap: wrap;
}
.vc-join-btn {
  margin-top: 5px;
  padding: 3px 6px;
  background: #43b581;
  border: none;
  color: white;
  cursor: pointer;
  border-radius: 3px;
}
.vc-mic-btn {
  margin-top: 5px;
  padding: 3px 6px;
  background: #faa61a;
  border: none;
  color: white;
  cursor: pointer;
  border-radius: 3px;
}
.msg {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  padding: 6px 8px;
  border-radius: 6px;
  transition: background 0.2s;
  max-width: 600px;
}

.msg:hover {
  background: rgba(255,255,255,0.05);
}

.msg > img {
  width: 47px;
  height: 47px;
  border-radius: 50%;
  flex-shrink: 0;
  image-rendering: auto;
  object-fit: cover;
  object-position: center;
}

.msg-image {
  width: auto;
  height: auto;
  max-width: 200px;
  max-height: 200px;
  border-radius: 8px;
  object-fit: contain;
}

.msg-content {
  flex: 1;
  min-width: 0;
  word-wrap: break-word;
}

.msg-embed {
  margin-top: 6px;
  border-radius: 8px;
  overflow: hidden;
  background: none;
  display: inline-block;
  width: auto;
}
.msg-embed img {
  display: inline-block;
  background: none;
  max-width: 200px;
  max-height: 200px;
  width: auto;
  height: auto;
  object-fit: contain;
  border-radius: 8px;
}

.msg-embed video,
.msg-embed iframe {
  display: block;
  width: 100%;
  height: auto;
  border-radius: 8px;
  object-fit: contain;
}

.msg .edit {
  color:#888;
  font-size:0.8em;
  cursor:pointer;
  display:none;
  margin-left:4px;
}
.msg:hover .delete,
.msg:hover .edit {
  display:inline;
}
.msg-edited {
  color:#888;
  font-size:0.75em;
  margin-left:4px;
}

</style>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/peerjs@1.4.7/dist/peerjs.min.js"></script>
</head>
<body>
<div id="login">
<h2>PASS</h2>
<input type="password" id="password" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰">
<button id="enter-button">å…¥ã‚‹</button>
</div>

<div id="app">
<div id="main">
<div id="channels">
<h3>SharkChat</h3>
<div id="user-settings">
<input id="username" placeholder="åå‰ã‚’å…¥åŠ›">
<input type="file" id="avatar" accept="image/*">
<img id="avatar-preview" src="" alt="avatar">
<button id="settings-button">âš™</button>
</div>
<div id="settings-panel">
<label>ãƒ•ã‚©ãƒ³ãƒˆ: <input id="font-setting" placeholder="ä¾‹: sans-serif"></label>
<label>æ–‡å­—ã®è‰²: <input id="text-color-setting" type="color"></label>
<label>è‰²1: <input id="color1-setting" type="color"></label>
<label>è‰²2: <input id="color2-setting" type="color"></label>
<label>è‡ªåˆ†ã®æ–‡å­—è‰²: <input type="color" id="my-text-color" value="#ffffff"></label>
<label>è¼ããƒ¡ãƒƒã‚»ãƒ¼ã‚¸: <input type="checkbox" id="glow-enabled"></label>
<label>è¼ãè‰²: <input type="color" id="glow-color" value="#ffff00"></label>
</div>
<div class="channel active" data-index="0"># å–‹ã‚‹1</div>
<div class="channel" data-index="1"># é€Ÿå ±</div>
<div class="channel" data-index="2"># å–‹ã‚‹2</div>
<div class="channel" data-index="3"># å–‹ã‚‹3</div>
<div class="vc-channel" data-index="0">
VC1
<button class="vc-join-btn">å…¥ã‚‹/å‡ºã‚‹</button>
<button class="vc-mic-btn">ãƒã‚¤ã‚¯ON</button>
<div class="vc-users"></div>
</div>
<div class="vc-channel" data-index="1">
VC2
<button class="vc-join-btn">å…¥ã‚‹/å‡ºã‚‹</button>
<button class="vc-mic-btn">ãƒã‚¤ã‚¯ON</button>
<div class="vc-users"></div>
</div>
</div>

<div id="chat">
<div id="chat-header"># å–‹ã‚‹1</div>
<div id="messages"></div>
<div id="resetBtn" style="position:fixed;left:10px;bottom:10px;font-size:20px;cursor:pointer">ğŸ—‘ï¸</div>
<div id="input-box">
<input id="msg" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›">
<button id="send-button">enterã§é€ä¿¡</button>
</div>
</div>
</div>
</div>

<script>
const firebaseConfig = {
  apiKey:"AIzaSyCPF0ieugcs05fLXYahHdaE5JCeXgOIw3A",
  authDomain:"sharkchat-9a0a5.firebaseapp.com",
  databaseURL:"https://sharkchat-9a0a5-default-rtdb.firebaseio.com",
  projectId:"sharkchat-9a0a5",
  storageBucket:"sharkchat-9a0a5.appspot.com",
  messagingSenderId:"932358584876",
  appId:"1:932358584876:web:afa8b9f8515c0ac6826f89"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let username = localStorage.getItem("username")||"åç„¡ã—";
let avatarURL = localStorage.getItem("avatarURL")||"";
let currentChannel=0;
let currentRef=null;
let inVC=false;
let localStream=null;
let remoteAudios = {};
let pageHidden=false;

document.addEventListener("visibilitychange",()=>{pageHidden=document.hidden;});

const userSettings = {
 myTextColor: localStorage.getItem("myTextColor") || "#ffffff",
 glowEnabled: localStorage.getItem("glowEnabled") === "true",
 glowColor: localStorage.getItem("glowColor") || "#ffff00"
 };

function applySettings(){
  const font=localStorage.getItem("font")||"sans-serif";
  const color1=localStorage.getItem("color1")||"#1e1e2f";
  const color2=localStorage.getItem("color2")||"#3a3a5c";
  const textColor=localStorage.getItem("textColor")||"white";
  document.body.style.fontFamily=font;
  document.getElementById("chat").style.background=`linear-gradient(to bottom right, ${color1}, ${color2})`;
  document.body.style.color=textColor;
}
document.getElementById("my-text-color").addEventListener("change", e=>{
  userSettings.myTextColor = e.target.value;
  localStorage.setItem("myTextColor", e.target.value);
  renderVirtual();
});

document.getElementById("glow-color").addEventListener("change", e=>{
  userSettings.glowColor = e.target.value;
  localStorage.setItem("glowColor", e.target.value);
  renderVirtual();
});

document.getElementById("glow-enabled").addEventListener("change", e=>{
  userSettings.glowEnabled = e.target.checked;
  localStorage.setItem("glowEnabled", e.target.checked);
  renderVirtual();
});

function checkPass(){
  const pass=document.getElementById('password').value;
  if(pass==="707107"){
    document.getElementById('login').remove()
    document.getElementById('app').style.display="block";
    document.getElementById('username').value=username;
    if(avatarURL) document.getElementById('avatar-preview').src=avatarURL;
    document.getElementById("font-setting").value=localStorage.getItem("font")||"";
    document.getElementById("text-color-setting").value=localStorage.getItem("textColor")||"#ffffff";
    document.getElementById("color1-setting").value=localStorage.getItem("color1")||"#1e1e2f";
    document.getElementById("color2-setting").value=localStorage.getItem("color2")||"#3a3a5c";
    applySettings();
    listenMessages();
  } else { alert("é–“é•ã£ãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰"); }
}

document.getElementById("resetBtn").onclick=()=>{
  if(currentChannel !== null && currentChannel !== undefined){
    const pass=prompt("ã“ã®ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã€‚ãƒªã‚»ãƒƒãƒˆã™ã‚‹ã«ã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚")
    if(pass==="0727"){
      db.ref("channel"+currentChannel).remove()
      alert("ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ")
    }else if(pass!==null){
      alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™")
    }
  }
}

function setUsername(){
  const input=document.getElementById('username').value;
  if(input.trim()!==""){ username=input.trim(); localStorage.setItem("username",username); }
}

function setAvatar(){
  const file=document.getElementById('avatar').files[0];
  if(!file) return;
  const reader=new FileReader();
  reader.onload=e=>{
    avatarURL=e.target.result;
    document.getElementById('avatar-preview').src=avatarURL;
    localStorage.setItem("avatarURL",avatarURL);
  };
  reader.readAsDataURL(file);
}

function switchChannel(index){
  currentChannel=index;
  document.getElementById("chat-header").textContent=["# å–‹ã‚‹1","# é€Ÿå ±","# å–‹ã‚‹2","# å–‹ã‚‹3"][index]||"# å–‹ã‚‹1";
  document.querySelectorAll(".channel").forEach((el,i)=>{el.classList.toggle("active",i===index);});
  listenMessages();
  updateVCDisplay();
}

function sendMsg(){
  const input = document.getElementById("msg");
  if(!input || input.value.trim() === "") return;
  const val = input.value.trim();

  if(val.startsWith("/")){
    if(command(val)){ 
      input.value = "";
      return;
    }
  }

  const msg = {
    name: username,
    avatar: avatarURL,
    text: val,
    timestamp: Date.now(),
    textColor: userSettings.myTextColor,
    glowEnabled: userSettings.glowEnabled ? "true" : "false",
    glowColor: userSettings.glowColor
  };
  db.ref("channel"+currentChannel).push(msg);
  input.value = "";
}

let allMessages = []

function listenMessages(){
  if(currentRef) currentRef.off();
  currentRef = db.ref("channel"+currentChannel);
  currentRef.on("value", snap => {
    const data = snap.val() || {};
    const oldKeys = allMessages.map(x => x.key);
    const entries = Object.entries(data).map(([k,v])=>({key:k,m:v})).sort((a,b)=>(a.m.timestamp||0)-(b.m.timestamp||0));
    allMessages = entries;
    const newKeys = entries.map(e=>e.key).filter(k=>!oldKeys.includes(k));
    if(newKeys.length){
      newKeys.forEach(k=>{
        const m = entries.find(x=>x.key===k).m;
        if(m.name!==username && pageHidden){
          if("Notification" in window && Notification.permission==="granted"){
            new Notification(m.name,{body:m.text,icon:m.avatar||"icon/favicon3.ico"});
          }
        }
      });
    }
    renderVirtual();
  });
}

let heights = {}
let totalHeight = 0

function renderVirtual(){
  const container = document.getElementById("messages")
  const viewHeight = container.clientHeight || 400
  const scrollTop = container.scrollTop
  const measure = document.createElement("div")
  measure.style.position="absolute"
  measure.style.visibility="hidden"
  measure.style.width = container.clientWidth+"px"
  document.body.appendChild(measure)
  allMessages.forEach(e=>{
    if(!heights[e.key]){
      measure.innerHTML = renderMessageHTML(e)
      heights[e.key] = measure.offsetHeight
    }
  })
  document.body.removeChild(measure)
  totalHeight = Object.values(heights).reduce((a,b)=>a+b,0)
  let start=0, y=0
  while(start<allMessages.length && y+heights[allMessages[start].key] < scrollTop){
    y += heights[allMessages[start].key]
    start++
  }
  let end=start, shownHeight=0
  while(end<allMessages.length && shownHeight<viewHeight*1.5){
    shownHeight += heights[allMessages[end].key]
    end++
  }
  const topPadding = y
  const bottomPadding = totalHeight - (y+shownHeight)
  let html = '<div style="height:'+topPadding+'px"></div>'
  for(let i=start;i<end;i++){
    html += renderMessageHTML(allMessages[i])
  }
  html += '<div style="height:'+bottomPadding+'px"></div>'
  container.innerHTML = html
}
function renderMessageHTML(e){
  const m = e.m
  const date = new Date(m.timestamp || Date.now())
  const dateStr = date.getFullYear()+'/'+(date.getMonth()+1)+'/'+date.getDate()+' '+date.getHours()+':'+String(date.getMinutes()).padStart(2,'0')
  const avatar = m.avatar || "icon/favicon3.ico"
  let style = `color:${m.textColor || "white"};`
  if(m.glowEnabled==="true" || m.glowEnabled===true){
    style += `text-shadow:0 0 8px ${m.glowColor||"#ffff00"};`
  }
    const del = (m.name===username || username==="SharkTomato")
    ? `<span class="delete" onclick="deleteMsg('${e.key}','${String(m.name).replace(/'/g,"\\'")}')">[å‰Šé™¤]</span>`
    : ''

  const edit = (m.name===username)
  ? `<span class="edit" onclick="editMsg('${e.key}')">[ç·¨é›†]</span>`
  : ''

  let contentHTML = m.text
  .replace(/\n/g, "<br>")
  .replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" style="color:#00aaff;text-decoration:underline;">$1</a>')
let embedHTML = ""

  let url = m.text.split(/[ ?&]/)[0]

  if(/\.(gif|png|jpeg|jpg|webp|avif)$/i.test(url)){
  embedHTML = `<div class="msg-embed"><img src="${m.text}" class="msg-image"></div>`
  contentHTML = ""
}
  else if(/\.(mp4|webm|ogg|mp3)$/i.test(url)){
    embedHTML = `<div class="msg-embed"><video src="${m.text}" controls></video></div>`
    contentHTML = ""
  }
  else if(/(youtube\.com\/watch\?v=|youtu\.be\/|youtube-nocookie\.com\/embed\/)/i.test(m.text)){
  let id = ""
  let base = "https://www.youtube.com/embed/"
  if(m.text.includes("watch?v=")) id = m.text.split("watch?v=")[1].split("&")[0]
  else if(m.text.includes("youtu.be/")) id = m.text.split("youtu.be/")[1].split("?")[0]
  else if(m.text.includes("youtube-nocookie.com/embed/")){
    id = m.text.split("youtube-nocookie.com/embed/")[1].split("?")[0]
    base = "https://www.youtube-nocookie.com/embed/"
  }
  embedHTML = `<div class="msg-embed"><iframe src="${base}${id}" allowfullscreen></iframe></div>`
}

   return `
    <div class="msg" data-key="${e.key}">
      <img src="${avatar}" width="36" height="36">
      <div class="msg-content">
        <div><b>${m.name}</b> <span style="font-size:0.8em;color:#aaa;">${dateStr}</span> ${del} ${edit}</div>
        <div style="${style}">${contentHTML}</div>
        ${embedHTML}
        ${m.edited ? '<div><span class="msg-edited">(ç·¨é›†æ¸ˆã¿)</span></div>' : ''}
      </div>
    </div>
  `
}

function deleteMsg(key, name){
  if(name === username || username === "SharkTomato"){
    delete heights[key];
    for(let i=0; i<4; i++){ 
      db.ref("channel"+i+"/"+key).remove();
    }
    renderVirtual();
  }
}

function updateVCDisplay(){
  document.querySelectorAll(".vc-channel").forEach((vc,idx)=>{
    const usersDiv=vc.querySelector(".vc-users");
    db.ref("vc"+idx).once("value",snap=>{
      const data=snap.val()||{};
      usersDiv.innerHTML=Object.values(data).map(u=>`<img src="${u.avatar}" title="${u.name}" style="width:36px;height:36px;border-radius:50%">`).join("");
    });
  });
}

document.addEventListener("DOMContentLoaded",()=>{
  document.getElementById("enter-button").addEventListener("click",checkPass);
  document.getElementById("username").addEventListener("change",setUsername);
  document.getElementById("avatar").addEventListener("change",setAvatar);
  document.querySelectorAll(".channel").forEach(el=>el.addEventListener("click",()=>switchChannel(parseInt(el.dataset.index))));
  document.getElementById("password").addEventListener("keydown",e=>{if(e.key==="Enter") checkPass();});
  document.getElementById("msg").addEventListener("keydown",e=>{if(e.key==="Enter") sendMsg();});
  document.getElementById("settings-button").addEventListener("click",()=>{const panel=document.getElementById("settings-panel");panel.style.display=panel.style.display==="flex"?"none":"flex";});
  document.getElementById("font-setting").addEventListener("change",e=>{localStorage.setItem("font",e.target.value);applySettings();});
  document.getElementById("text-color-setting").addEventListener("change",e=>{localStorage.setItem("textColor",e.target.value);applySettings();});
  document.getElementById("color1-setting").addEventListener("change",e=>{localStorage.setItem("color1",e.target.value);applySettings();});
  document.getElementById("color2-setting").addEventListener("change",e=>{localStorage.setItem("color2",e.target.value);applySettings();});
  applySettings();
ã€€document.getElementById("messages").addEventListener("scroll", renderVirtual)

  const peer = new Peer(username);
  document.querySelectorAll(".vc-join-btn").forEach((btn, idx)=>{
    const vcChannel = document.querySelectorAll(".vc-channel")[idx];
    const usersDiv = vcChannel.querySelector(".vc-users");
    const micBtn = vcChannel.querySelector(".vc-mic-btn");
    const channelName = "vc" + idx;

    micBtn.addEventListener("click",()=>{
      if(!localStream) return;
      localStream.getAudioTracks().forEach(t=>t.enabled=!t.enabled);
      micBtn.textContent = localStream.getAudioTracks()[0].enabled?"ãƒã‚¤ã‚¯ON":"ãƒã‚¤ã‚¯OFF";
    });

    btn.addEventListener("click", async ()=>{
      if(!inVC){
        localStream = await navigator.mediaDevices.getUserMedia({ audio:true });
        peer.on("call", call=>{
          call.answer(localStream);
          call.on("stream", s=>{
            if(!remoteAudios[call.peer]){
              const audio = document.createElement("audio");
              audio.srcObject = s;
              audio.autoplay = true;
              vcChannel.appendChild(audio);
              remoteAudios[call.peer] = audio;
            }
          });
        });

        await db.ref(channelName+"/"+peer.id).set({name:username,avatar:avatarURL,id:peer.id});
        db.ref(channelName+"/"+peer.id).onDisconnect().remove();

        db.ref(channelName).on("value",snap=>{
          const data=snap.val()||{};
          usersDiv.innerHTML=Object.values(data).map(u=>`<img src="${u.avatar}" title="${u.name}" style="width:36px;height:36px;border-radius:50%">`).join("");
          Object.values(data).forEach(u=>{
            if(u.id && u.id!==peer.id && !remoteAudios[u.id]){
              const call=peer.call(u.id,localStream);
              call.on("stream",s=>{
                const audio=document.createElement("audio");
                audio.srcObject=s;
                audio.autoplay=true;
                vcChannel.appendChild(audio);
                remoteAudios[u.id]=audio;
              });
            }
          });
        });
        inVC=true;
      } else {
        if(localStream) localStream.getTracks().forEach(t=>t.stop());
        Object.values(remoteAudios).forEach(a=>a.remove());
        remoteAudios={};
        await db.ref(channelName+"/"+peer.id).remove();
        inVC=false;
      }
    });
  });
});
let hiddenUI = false

document.addEventListener("keydown", e=>{
  if(e.key.toLowerCase()==="h" && e.shiftKey){
    const active = document.activeElement
    if(active && ["input","textarea"].includes(active.tagName.toLowerCase())) return
    if(active && active.isContentEditable) return
    hiddenUI = !hiddenUI
    document.getElementById("channels").style.display = hiddenUI ? "none" : "flex"
    document.getElementById("chat-header").style.display = hiddenUI ? "none" : "block"
  }
})

    function editMsg(key){
  const ref = db.ref("channel"+currentChannel+"/"+key)
  ref.once("value").then(snap=>{
    const m = snap.val()
    if(!m) return
    if(m.name!==username) return
    const clean = String(m.text || "")
      .replace(/\s*\(ç·¨é›†æ¸ˆã¿\)\s*$/,"")
      .replace(/<[^>]*>/g,"")
      .trim()
    const newText = prompt("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç·¨é›†:", clean)
    if(newText===null) return
    const cleanNew = newText
      .replace(/\s*\(ç·¨é›†æ¸ˆã¿\)\s*$/,"")
      .replace(/<[^>]*>/g,"")
      .trim()
    m.text = cleanNew
    m.edited = true
    m.timestamp = Date.now()
    ref.set(m)
  })
}

function command(cmd){
  if(cmd==="/help"){
    db.ref("channel"+currentChannel).push({
      name:"ã‚·ã‚¹ãƒ†ãƒ ",
      avatar:"",
      text:"/nizi  /hello  /help  /unko  /naniwo  /sumimasen  /tairyounaniwo  /fuck  /sanes  /pafeiwasi  /saikoro  /nyancat  /tairyounizi",
      timestamp:Date.now(),
      textColor:"#00ff00",
      glowEnabled:"false",
      glowColor:"#ffff00"
    })
    return true
  }
  if(cmd==="/nizi"){
    const rainbow=["ğŸŸ¥","ğŸŸ§","ğŸŸ¨","ğŸŸ©","ğŸŸ¦","ğŸŸª"]
    rainbow.forEach((c,i)=>{
      setTimeout(()=>{
        db.ref("channel"+currentChannel).push({
          name:"ã‚·ã‚¹ãƒ†ãƒ ",
          avatar:"",
          text:c,
          timestamp:Date.now(),
          textColor:"#ffffff",
          glowEnabled:"false",
          glowColor:"#ffff00"
        })
      }, i*120)
    })
    return true
  }
  if(cmd==="/tairyounizi"){
    const tairyourainbow=["ğŸŸ¥","ğŸŸ§","ğŸŸ¨","ğŸŸ©","ğŸŸ¦","ğŸŸª","ğŸŸ¥","ğŸŸ§","ğŸŸ¨","ğŸŸ©","ğŸŸ¦","ğŸŸª","ğŸŸ¥","ğŸŸ§","ğŸŸ¨","ğŸŸ©","ğŸŸ¦","ğŸŸª","ğŸŸ¥","ğŸŸ§","ğŸŸ¨","ğŸŸ©","ğŸŸ¦","ğŸŸª","ğŸŸ¥","ğŸŸ§","ğŸŸ¨","ğŸŸ©","ğŸŸ¦","ğŸŸª"]
    tairyourainbow.forEach((c,i)=>{
      setTimeout(()=>{
        db.ref("channel"+currentChannel).push({
          name:"ã‚·ã‚¹ãƒ†ãƒ ",
          avatar:"",
          text:c,
          timestamp:Date.now(),
          textColor:"#ffffff",
          glowEnabled:"false",
          glowColor:"#ffff00"
        })
      }, i*120)
    })
    return true
  }
  if(cmd==="/hello"){
    db.ref("channel"+currentChannel).push({
      name:"ã‚·ã‚¹ãƒ†ãƒ ",
      avatar:"",
      text:"Hello World!",
      timestamp:Date.now(),
      textColor:"#00ff00",
      glowEnabled:"false",
      glowColor:"#ffff00"
    })
    return true
  }
  if(cmd==="/sumimasen"){
    const sumimasen=["ãŸ","ã„","ã¸","ã‚“","ã‚‚","ã†","ã—","ã‚","ã‘","ã”","ã–","ã„","ã¾","ã›","ã‚“","ã§","ãŸ"]
    sumimasen.forEach((c,i)=>{
      setTimeout(()=>{
        db.ref("channel"+currentChannel).push({
          name:"ã‚·ã‚¹ãƒ†ãƒ ",
          avatar:"",
          text:c,
          timestamp:Date.now(),
          textColor:"#ffffff",
          glowEnabled:"false",
          glowColor:"#ffff00"
        })
      }, i*120)
    })
    return true
  }
  if(cmd==="/unko"){
    db.ref("channel"+currentChannel).push({
      name:"ã‚·ã‚¹ãƒ†ãƒ ",
      avatar:"",
      text:"buriburiğŸ’©ğŸ’©ğŸ’©",
      timestamp:Date.now(),
      textColor:"#ffffff",
      glowEnabled:"false",
      glowColor:"#ffff00"
    })
    return true
  }
  if(cmd==="/naniwo"){
    db.ref("channel"+currentChannel).push({
      name:"ã‚·ã‚¹ãƒ†ãƒ ",
      avatar:"",
      text:"ä½•ã‚’å››å¤©ç‹",
      timestamp:Date.now(),
      textColor:"#ffffff",
      glowEnabled:"false",
      glowColor:"#ffff00"
    })
    return true
  }
  if(cmd==="/tairyounaniwo"){
    const tana=["ä½•ã‚’å››å¤©ç‹","ä½•ã‚’å››å¤©ç‹ï¼Ÿ","ä½•ã‚’å››å¤©ç‹","ä½•ã‚’å››å¤©ç‹ï¼Ÿ","ä½•ã‚’å››å¤©ç‹","ä½•ã‚’å››å¤©ç‹ï¼Ÿ","ä½•ã‚’å››å¤©ç‹","ä½•ã‚’å››å¤©ç‹ï¼Ÿ","ä½•ã‚’å››å¤©ç‹","ä½•ã‚’å››å¤©ç‹ï¼Ÿ"]
    tana.forEach((c,i)=>{
      setTimeout(()=>{
        db.ref("channel"+currentChannel).push({
          name:"ã‚·ã‚¹ãƒ†ãƒ ",
          avatar:"",
          text:c,
          timestamp:Date.now(),
          textColor:"#ffffff",
          glowEnabled:"false",
          glowColor:"#ffff00"
        })
      }, i*120)
    })
    return true
  }
  if(cmd==="/pafeiwasi"){
    const pa=["ãƒãƒãƒ","ä¸­ãƒˆãƒ­","ç”˜ã‚¨ãƒ“ãƒ­ãƒ¼ãƒ«","ã‚µãƒ¼ãƒ¢ãƒ³","ãƒãƒ³ãƒãƒ¼ã‚°","ã„ãªã‚Š","ã‚µãƒ©ãƒ€","ã‚µãƒ¼ãƒ¢ãƒ³ç‚™ã‚Š","ãƒ‘ãƒ•ã‚§","ã„ã‚ã—"]
    pa.forEach((c,i)=>{
      setTimeout(()=>{
        db.ref("channel"+currentChannel).push({
          name:"ãã‚…ã†ã‚Šå¯¿å¸",
          avatar:"",
          text:c,
          timestamp:Date.now(),
          textColor:"#ffffff",
          glowEnabled:"false",
          glowColor:"#ffff00"
        })
      }, i*120)
    })
    return true
  }
  if(cmd==="/saikoro"){
  const num = Math.floor(Math.random() * 6) + 1
  db.ref("channel"+currentChannel).push({
    name:"ã‚·ã‚¹ãƒ†ãƒ ",
    avatar:"",
    text:"ã‚µã‚¤ã‚³ãƒ­ã®ç›®: "+num,
    timestamp:Date.now(),
    textColor:"#ffffff",
    glowEnabled:"false",
    glowColor:"#ffff00"
  })
  return true
}
if(cmd==="/sanes"){
  db.ref("channel"+currentChannel).push({
    name:"ã‚·ã‚¹ãƒ†ãƒ ",
    avatar:"",
    text:'<img src="https://media.tenor.com/r0GIKcYiA3kAAAAi/sans-dance.gif" alt="a black and white drawing of sans from undertale"/>',
    timestamp:Date.now(),
    textColor:"#ffffff",
    glowEnabled:"false",
    glowColor:"#ffff00"
  })
  return true
}
if(cmd==="/fuck"){
  db.ref("channel"+currentChannel).push({
    name:"ã‚·ã‚¹ãƒ†ãƒ ",
    avatar:"",
    text:'<img src="https://media1.tenor.com/m/KlOvFD0acnsAAAAC/fuck-you-fuck.gif" alt="a green uno card with three middle fingers pointing in opposite directions"/>',
    timestamp:Date.now(),
    textColor:"#ffffff",
    glowEnabled:"false",
    glowColor:"#ffff00"
  })
  return true
}
 if(cmd==="/nyancat"){
  db.ref("channel"+currentChannel).push({
    name:"ã‚·ã‚¹ãƒ†ãƒ ",
    avatar:"",
    text:"\n"+"â€¢.,Â¸,.â€¢*Â¯`â€¢.,Â¸Â¸,.â€¢*Â¯â•­â”â”â”â”â•®\n"+
         "â€¢.,Â¸,.â€¢*Â¯`â€¢.,Â¸,.â€¢*Â¯.|:::::::::: /\\___/\\\n"+
         "â€¢.,Â¸,.â€¢*Â¯`â€¢.,Â¸,.â€¢* <|:::::::::(ï½¡ â—Ï‰â—ï½¡)\n"+
         "â€¢.,Â¸,.â€¢*Â¯`â€¢.,Â¸,.â€¢* â•°ã—------ã—---   ï¼ª",
    timestamp:Date.now(),
    textColor:"#ffffff",
    glowEnabled:"false",
    glowColor:"#ffff00"
  })
  return true
}
  return false
}

</script>
</body>
</html>
